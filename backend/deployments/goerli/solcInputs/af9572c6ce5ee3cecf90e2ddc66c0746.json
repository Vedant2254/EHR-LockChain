{
  "language": "Solidity",
  "sources": {
    "contracts/Contract.sol": {
      "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.17;\n\nimport \"./Roles.sol\";\n\nerror Contract__NotAdmin();\nerror Contract__NotDoctor();\nerror Contract__NotPatient();\n\ncontract Contract {\n    // using methods of Roles for Role struct in Roles\n    using Roles for Roles.Role;\n\n    // defining roles\n    Roles.Role private admin;\n    Roles.Role private doctor;\n    Roles.Role private patient;\n\n    // This is to store ids (addresses) of admin, doctors and patients\n    address private admin_id;\n    address[] private dr_ids;\n    address[] private pat_ids;\n\n    // This is to store hash of data of doctors and patients\n    mapping(address => string) Doctors;\n    mapping(address => string) Patients;\n    mapping(address => mapping(address => bool)) Access;\n\n    // Initializing admin\n    constructor() {\n        admin_id = msg.sender;\n        admin.add(msg.sender);\n    }\n\n    // Admin methods\n    function getAdmin() public view returns (address) {\n        return admin_id;\n    }\n\n    function isAdmin(address _address) public view returns (bool) {\n        return admin.has(_address);\n    }\n\n    // Doctor methods\n    function isDoctor(address _address) public view returns (bool) {\n        return doctor.has(_address);\n    }\n\n    function setDrHash(address _address, string memory _hash) public onlyAdmin {\n        Doctors[_address] = _hash;\n    }\n\n    function addDoctor(address _address, string memory _hash) public onlyAdmin {\n        doctor.add(_address);\n        dr_ids.push(_address);\n        setDrHash(_address, _hash);\n    }\n\n    function getAllDrs() public view returns (address[] memory) {\n        return dr_ids;\n    }\n\n    function getDrHash(address _address) public view returns (string memory) {\n        if (!isDoctor(_address)) revert Contract__NotDoctor();\n        return Doctors[_address];\n    }\n\n    // Patient methods\n    function isPatient(address _address) public view returns (bool) {\n        return patient.has(_address);\n    }\n\n    function addPatient() public {\n        patient.add(msg.sender);\n        pat_ids.push(msg.sender);\n    }\n\n    function setPatHash(\n        address _address,\n        string memory _hash\n    ) public onlyDoctor {\n        if (!isPatient(_address)) revert Contract__NotPatient();\n        if (Access[_address][msg.sender]) revert(\"Not Allowed!\");\n        Patients[_address] = _hash;\n    }\n\n    function getAllPats() public view returns (address[] memory) {\n        return pat_ids;\n    }\n\n    function getPatHash(address _address) public view returns (string memory) {\n        if (!isPatient(_address)) revert Contract__NotPatient();\n\n        if (msg.sender != _address && Access[_address][msg.sender])\n            revert(\"Now Allowed!\");\n\n        return Patients[_address];\n    }\n\n    function giveAccess(address _address) public onlyPatient {\n        if (!isDoctor(_address)) revert Contract__NotDoctor();\n        Access[msg.sender][_address] = true;\n    }\n\n    // modifiers\n    modifier onlyAdmin() {\n        if (!admin.has(msg.sender)) revert Contract__NotAdmin();\n        _;\n    }\n\n    modifier onlyDoctor() {\n        if (!doctor.has(msg.sender)) revert Contract__NotDoctor();\n        _;\n    }\n\n    modifier onlyPatient() {\n        if (!patient.has(msg.sender)) revert Contract__NotPatient();\n        _;\n    }\n}\n"
    },
    "contracts/Roles.sol": {
      "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.17;\n\nlibrary Roles {\n    // This is to keep track of roles\n    // Reduces searching cost\n    struct Role {\n        mapping(address => bool) bearer;\n    }\n\n    function add(Role storage role, address account) internal {\n        require(!has(role, account), \"Roles: account already has role\");\n        role.bearer[account] = true;\n    }\n\n    function remove(Role storage role, address account) internal {\n        require(has(role, account), \"Roles: account does not have role\");\n        role.bearer[account] = false;\n    }\n\n    function has(\n        Role storage role,\n        address account\n    ) internal view returns (bool) {\n        require(account != address(0), \"Roles: account is the zero address\");\n        return role.bearer[account];\n    }\n}\n"
    }
  },
  "settings": {
    "optimizer": {
      "enabled": false,
      "runs": 200
    },
    "outputSelection": {
      "*": {
        "*": [
          "abi",
          "evm.bytecode",
          "evm.deployedBytecode",
          "evm.methodIdentifiers",
          "metadata",
          "devdoc",
          "userdoc",
          "storageLayout",
          "evm.gasEstimates"
        ],
        "": [
          "ast"
        ]
      }
    },
    "metadata": {
      "useLiteralContent": true
    }
  }
}